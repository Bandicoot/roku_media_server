<html>
	<head>
		<script src="js/jquery.js" type="text/javascript"></script>
		<script src="js/editable.js" type="text/javascript"></script>
		<script type="text/javascript">
			$(document).ready(function() {
					function zebraStripes() {
						// fix zebra stripes
						$(".item:nth-child(odd)").addClass("item_odd");
					}

					function itemEdit() {
						$("#status").text("Press tab to stop editing");
					}
					function itemSubmitted() {
						$("#status").empty();
					}

					function addItem(text) {
						var item_row = $('<div class="item_row"/>');
						var item = $('<span class="item">' + text + '</span>');
						item.appendTo(item_row);
						item_row.appendTo('.item_list');
						item.editable({onEdit:itemEdit, onSubmit:itemSubmitted});
						zebraStripes();
					};

					$("#add").click(function() {
						addItem('Click to edit...');
					});

					$("#save").click(function() {
						var items = $(".item_list").children(".item_row").children(".item").map(function () {
							return $(this).text();
						}).get();
						$.post('/dynplay', $.param({ song:items }, true));
					});

					$(".item_list").delegate(".item", "mouseover", function() {
						$(this).addClass("item_hover");
						$(".delete").remove();
						$(this).after('<a href="#" class="delete">[delete]</a>');
					});

					$(".item_list").delegate(".item", "mouseout", function() {
						$(this).removeClass("item_hover");
					});

					$(".item_list").delegate(".delete", "click", function() {
						$(this).parent().remove();
					});

					// load what's on the server now
					$.get('/dynplay', function(txt) {
						$.each(txt.split("\n"), function() {
							if(this != "") {
								addItem(this);
							}
						});
					});
			});
		</script>

		<style type='text/css'>
			.container {
				width: 600px;
				background: #f0f0f0;
			}

			.item_list {
				background: #ffffff;
			}

			.item {
				border-style: solid;
				border-color: black;
				border-width: 0px 0px 1px 0px;
			}

			.item_odd {
				background: #e6e6e6;
			}

			.item_hover {
				background: #ccccee;
			}

			#status {
				font-size: 10pt;
				color: #444;
			}

			.delete {
				font-size: 9pt;
				color: #c55;
			}
		</style>
		<title>Playlist Editor</title>

	</head>

	<body>
		<div class="container">
			<div class="item_list">
			</div>
			<div class="controls">
				<button id="add">Add</button>
				<button id="save">Save</button>
				<span id="status"></span>
			</div>
		</div>
	</body>
</html>
